import{_ as g}from"./_plugin-vue_export-helper.cdc0426e.js";import{V as v,a as k,b as n}from"./VSpacer.1cd00b13.js";import{o as y,Z as x,R as V,_ as C,T as a,y as t,W as o,ab as D,X as r,z as T,ag as P,ak as w,al as c,U as u}from"./index.f457a545.js";import{V as p,a as h,b as f,c as O,d as I}from"./VDialog.1988f6ec.js";import{b as j,V as z,a as m}from"./VRow.297e3676.js";const A={data:()=>({dialog:!1,dialogDelete:!1,headers:[{title:"Id",align:"start",sortable:!1,key:"id"},{title:"Clave Catastral",sortable:!1,key:"clave_catastral"},{title:"Descripci\xF3n",sortable:!1,key:"descripcion"},{title:"Id del Arrendatario",sortable:!1,key:"arrId"},{title:"Actions",key:"actions",sortable:!1}],datos:[],editedIndex:-1,editedItem:{id:0,clave_catastral:"",descripcion:"",arrId:0,Propietarios:[]},defaultItem:{id:0,clave_catastral:"",descripcion:"",arrId:0,Propietarios:[]}}),computed:{formTitle(){return this.editedIndex===-1?"New Item":"Edit Item"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()}},created(){this.initialize()},methods:{initialize(){y(async()=>{const d=await(await fetch("http://localhost:4000/propiedades")).json();console.log(d),this.datos=d.map(i=>({id:i.id,clave_catastral:i.clave_catastral,descripcion:i.descripcion,arrId:i.ArrendatarioId,Propietarios:i.Propietarios}))})},editItem(e){this.editedIndex=this.datos.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem(e){this.editedIndex=this.datos.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm(){this.datos.splice(this.editedIndex,1),this.deletePropiedad(this.editedItem),this.closeDelete()},close(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save(){if(this.editedIndex>-1){Object.assign(this.datos[this.editedIndex],this.editedItem);const e=JSON.stringify({id:this.editedItem.id,clave_catastral:this.editedItem.clave_catastral,descripcion:this.editedItem.descripcion,ArrendatarioId:this.editedItem.arrId});console.log("save "+e),this.updatePropiedad(e)}else{this.datos.push(this.editedItem);const e=JSON.stringify({clave_catastral:this.editedItem.clave_catastral,descripcion:this.editedItem.descripcion,ArrendatarioId:this.editedItem.arrId});this.postPropiedad(e)}this.close()},async postPropiedad(e){(await fetch("http://localhost:4000/propiedades",{method:"POST",headers:{"Content-Type":"application/json"},body:e})).json().then(i=>{console.log(i)}),this.initialize()},async updatePropiedad(e){console.log("update "+e),(await fetch("http://localhost:4000/propiedades",{method:"PATCH",headers:{"Content-Type":"application/json"},body:e})).json().then(i=>{console.log(i)}),this.initialize()},async deletePropiedad(e){(await fetch("http://localhost:4000/propiedades/"+e.id,{method:"DELETE"})).json().then(i=>{console.log(i)})}}},E={class:"text-h5"};function N(e,d,i,U,B,s){const _=x("v-data-table");return V(),C(_,{headers:e.headers,items:e.datos,class:"elevation-1"},{top:a(()=>[t(v,{flat:""},{default:a(()=>[t(k,null,{default:a(()=>[o("PROPIEDADES")]),_:1}),t(D,{class:"mx-4",inset:"",vertical:""}),t(n),t(p,{modelValue:e.dialog,"onUpdate:modelValue":d[4]||(d[4]=l=>e.dialog=l),"max-width":"800px"},{activator:a(({props:l})=>[t(r,T({color:"primary",dark:"",class:"mb-2"},l),{default:a(()=>[o(" Nueva propiedad ")]),_:2},1040)]),default:a(()=>[t(h,null,{default:a(()=>[t(f,null,{default:a(()=>[P("span",E,w(s.formTitle),1)]),_:1}),t(O,null,{default:a(()=>[t(j,null,{default:a(()=>[t(z,null,{default:a(()=>[t(m,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(c,{modelValue:e.editedItem.id,"onUpdate:modelValue":d[0]||(d[0]=l=>e.editedItem.id=l),label:"Id"},null,8,["modelValue"])]),_:1}),t(m,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(c,{modelValue:e.editedItem.clave_catastral,"onUpdate:modelValue":d[1]||(d[1]=l=>e.editedItem.clave_catastral=l),label:"Clave Catastral"},null,8,["modelValue"])]),_:1}),t(m,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(c,{modelValue:e.editedItem.descripcion,"onUpdate:modelValue":d[2]||(d[2]=l=>e.editedItem.descripcion=l),label:"Descripci\xF3n"},null,8,["modelValue"])]),_:1}),t(m,{cols:"12",sm:"6",md:"4"},{default:a(()=>[t(c,{modelValue:e.editedItem.arrId,"onUpdate:modelValue":d[3]||(d[3]=l=>e.editedItem.arrId=l),label:"Id del arrendatario"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(I,null,{default:a(()=>[t(n),t(r,{color:"blue-darken-1",variant:"text",onClick:s.close},{default:a(()=>[o(" Cancel ")]),_:1},8,["onClick"]),t(r,{color:"blue-darken-1",variant:"text",onClick:s.save},{default:a(()=>[o(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(p,{modelValue:e.dialogDelete,"onUpdate:modelValue":d[5]||(d[5]=l=>e.dialogDelete=l),"max-width":"500px"},{default:a(()=>[t(h,null,{default:a(()=>[t(f,{class:"text-h5"},{default:a(()=>[o("\xBFEstas seguro que deseas borrar?")]),_:1}),t(I,null,{default:a(()=>[t(n),t(r,{color:"blue-darken-1",variant:"text",onClick:s.closeDelete},{default:a(()=>[o(" Cancel ")]),_:1},8,["onClick"]),t(r,{color:"blue-darken-1",variant:"text",onClick:s.deleteItemConfirm},{default:a(()=>[o(" Ok ")]),_:1},8,["onClick"]),t(n)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":a(({item:l})=>[t(u,{size:"small",class:"me-2",onClick:b=>s.editItem(l.raw),icon:"mdi-pencil"},null,8,["onClick"]),t(u,{size:"small",class:"me-2",onClick:b=>s.deleteItem(l.raw),icon:"mdi-delete"},null,8,["onClick"])]),"no-data":a(()=>[t(r,{color:"primary",onClick:s.initialize},{default:a(()=>[o("Reset")]),_:1},8,["onClick"])]),_:1},8,["headers","items"])}const S=g(A,[["render",N]]),L={__name:"Propiedades",setup(e){return(d,i)=>(V(),C(S))}};export{L as default};
